<!DOCTYPE html>
<html>

<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?639ab28f32e0029ed25324113f0ff34a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<head>
  <meta charset="utf-8">
  
  <title>运维生存时间</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="运维 生存时间 ttl op oa">
<meta property="og:type" content="website">
<meta property="og:title" content="运维生存时间">
<meta property="og:url" content="http://ttlop.com/page/7/index.html">
<meta property="og:site_name" content="运维生存时间">
<meta property="og:description" content="运维 生存时间 ttl op oa">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="运维生存时间">
<meta name="twitter:description" content="运维 生存时间 ttl op oa">
  
    <link rel="alternate" href="/atom.xml" title="运维生存时间" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">运维生存时间</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">业精于勤而荒于嬉，行成于思而毁于随</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/About">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://ttlop.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Nginx-nginx-status" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/01/Nginx-nginx-status/" class="article-date">
  <time datetime="2016-06-01T06:43:29.000Z" itemprop="datePublished">2016-06-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/01/Nginx-nginx-status/">Nginx nginx-status</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>如何查看 Nginx 状态？</p>
        
          <p class="article-more-link">
            <a href="/2016/06/01/Nginx-nginx-status/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/06/01/Nginx-nginx-status/" data-id="cirbnztip003rc5pvt6c899ui" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Nginx-Location-Configuration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/01/Nginx-Location-Configuration/" class="article-date">
  <time datetime="2016-06-01T02:59:50.000Z" itemprop="datePublished">2016-06-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/01/Nginx-Location-Configuration/">Nginx Location Configuration</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>语法规则：location [=|~|~*|^~] /url/ {…}</p>
</blockquote>
<ul>
<li><p>= 表示精确匹配</p>
</li>
<li><p>^~ 表示 url 以某个常规字符串开头，理解为匹配 url 路径即可</p>
</li>
<li><p>~ 表示区分大小写的正则匹配</p>
</li>
<li><p>~* 表示不区分大小写的正则匹配</p>
</li>
<li><p>!~和!~* 分别为区分大小写不匹配和不区分大小写的不匹配</p>
</li>
<li><p>/ 通用匹配，任何请求都回匹配到</p>
</li>
</ul>
<p>多个 location 配置的情况下匹配顺序为：首先匹配 =，其次匹配 ^~，其次按文件中顺序的正则匹配，最后是交给 / 通用匹配。当有匹配成功的时候，停止匹配，按当前匹配规则处理请求。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">location = / &#123;</span><br><span class="line">   #ruleA</span><br><span class="line">&#125;</span><br><span class="line">location = /login&#123;</span><br><span class="line">   #ruleB</span><br><span class="line">&#125;</span><br><span class="line">location ^~ /static/ &#123;</span><br><span class="line">   #ruleC</span><br><span class="line">&#125;</span><br><span class="line">location ~ \.(gif|jpg|png|js|css)$ &#123;</span><br><span class="line">   #ruleD</span><br><span class="line">&#125;</span><br><span class="line">location ~* \.png$ &#123;</span><br><span class="line">   #ruleE</span><br><span class="line">&#125;</span><br><span class="line">location !~ \.xhtml$ &#123;</span><br><span class="line">   #ruleF</span><br><span class="line">&#125;</span><br><span class="line">location !~* \.xhtml$ &#123;</span><br><span class="line">   #ruleG</span><br><span class="line">&#125;</span><br><span class="line">location / &#123;</span><br><span class="line">   #ruleH</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么产生的效果如下：</p>
<ol>
<li><p>访问根目录/，比如 <strong><a href="http://localhost/" target="_blank" rel="external">http://localhost/</a></strong> 将匹配规则 <strong>ruleA</strong></p>
</li>
<li><p>访问 <strong><a href="http://localhost/static/a.html" target="_blank" rel="external">http://localhost/static/a.html</a></strong> 将匹配规则 <strong>ruleC</strong></p>
</li>
<li><p>访问 <strong><a href="http://localhost/login" target="_blank" rel="external">http://localhost/login</a></strong> 将匹配规则 <strong>ruleB</strong></p>
</li>
<li><p>访问 <strong><a href="http://localhost/a.gif" target="_blank" rel="external">http://localhost/a.gif</a></strong>、<strong><a href="http://localhost/b.png" target="_blank" rel="external">http://localhost/b.png</a></strong> 将匹配规则 <strong>ruleD</strong> 和 <strong>ruleE</strong>，但是规则 <strong>ruleD</strong> 优先，<strong>ruleE</strong> 不起作用</p>
</li>
<li><p>访问 <strong><a href="http://localhost/static/c.png" target="_blank" rel="external">http://localhost/static/c.png</a></strong> 则优先匹配规则 <strong>ruleC</strong></p>
</li>
<li><p>访问 <strong><a href="http://localhost/a.PNG" target="_blank" rel="external">http://localhost/a.PNG</a></strong> 则匹配规则 <strong>ruleE</strong>，不匹配规则 <strong>ruleD</strong>，因为规则 <strong>ruleE</strong> 不区分大小写</p>
</li>
<li><p>访问 <strong><a href="http://localhost/a.xhtml" target="_blank" rel="external">http://localhost/a.xhtml</a></strong> 不会匹配规则 <strong>ruleF</strong> 和 <strong>ruleG</strong>，<strong><a href="http://localhost/a.XHTML" target="_blank" rel="external">http://localhost/a.XHTML</a></strong> 不会匹配规则 <strong>ruleG</strong>。规则 <strong>ruleF</strong> 和 <strong>ruleG</strong> 属于排除法，符合匹配规则但是不会匹配。</p>
</li>
<li><p>访问 <strong><a href="http://localhost/category/id/1111" target="_blank" rel="external">http://localhost/category/id/1111</a></strong> 则最终匹配到规则 <strong>ruleH</strong>，因为以上规则都不进行匹配</p>
</li>
</ol>
<p>所以在实际使用中，个人觉得至少有三个匹配规则定义，如下：</p>
<ul>
<li>直接匹配网站根，通过域名访问网站首页比较频繁，使用这个会加速处理</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location = / &#123;</span><br><span class="line">    proxy_pass http://tomcat:8080/index</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>处理静态文件请求，这是 <strong>nginx</strong> 作为 <strong>http</strong> 服务器的强项</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location ^~ /static/ &#123;</span><br><span class="line">    root /webroot/static;</span><br><span class="line">&#125;</span><br><span class="line">#or</span><br><span class="line">location ~* \.(gif|jpg|jpeg|png|css|js|ico)$ &#123;</span><br><span class="line">    root /webroot/res/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>转发动态请求到后端应用服务器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    proxy_pass http://tomcat:8080/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/06/01/Nginx-Location-Configuration/" data-id="cirbnztin003pc5pvpb5x0tt1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Zabbix-CPU-类型-Key" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/31/Zabbix-CPU-类型-Key/" class="article-date">
  <time datetime="2016-05-31T07:47:07.000Z" itemprop="datePublished">2016-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Zabbix/">Zabbix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/31/Zabbix-CPU-类型-Key/">Zabbix CPU 类型 Key</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Zabbix 服务器通过与 zabbix agent 通信来获取客户端的数据，如下是一些 zabbix agent 所支持的 keys 列表。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Key</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">system.cpu.num[<type>]</type></td>
<td style="text-align:left">处理器个数。<strong>type</strong>-可用值: online(default),max</td>
</tr>
<tr>
<td style="text-align:left">system.cpu.switches</td>
<td style="text-align:left">上下文交换次数。老命名方式：system[switches]</td>
</tr>
<tr>
<td style="text-align:left">system.cpu.util[<cpu>,<type>,<mode>]</mode></type></cpu></td>
<td style="text-align:left">利用率百分比。<strong>cpu</strong>-cpu数量(默认是所有CPU) <strong>type</strong>-可用值: idle,nice,user(default),system(windows default),iowait,interrupt,softirq,steal <strong>mode</strong>-可用值:avg1(default),avg5,avg15</td>
</tr>
<tr>
<td style="text-align:left">system.cpu.load[<cpu>,<mode>]</mode></cpu></td>
<td style="text-align:left">CPU负载。<strong>cpu</strong>-可用值:all(default),percpu(所有在线cpu的负载) <strong>mode</strong>-可用值:avg1,avg5,avg15</td>
</tr>
<tr>
<td style="text-align:left">system.cpu.intr</td>
<td style="text-align:left">设备中断次数</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/31/Zabbix-CPU-类型-Key/" data-id="cirbnztjf004mc5pvkrlulvm4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Nginx-FastCGI-运行原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/28/Nginx-FastCGI-运行原理/" class="article-date">
  <time datetime="2016-05-28T08:29:48.000Z" itemprop="datePublished">2016-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/28/Nginx-FastCGI-运行原理/">Nginx FastCGI 运行原理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>FastCGI 是一个可伸缩地、高速地在 HTTP server 和动态脚本语言间通信的接口。多数流行的 HTTP server 都支持 FastCGI，包括 Apache、Nginx、lighttpd等。同时，FastCGI 也被许多脚本语言支持，其中就有 PHP。</p>
<p>FastCGI 是从 CGI 发展改进来的。传统 CGI 接口方式的主要特点是性能很差，因为每次 HTTP 服务器遇到动态程序使都需要重新启动脚本解释器来执行解析，然后将结果返回给 HTTP 服务器。这在处理高并发访问时几乎是不可用的。另外传统的 CGI 接口方式安全性也很差，现在已经很少用了。</p>
<p>FastCGI 接口方式采用 C/S 架构，可以将 HTTP 服务器和脚本解析服务器分开，同时在脚本解析服务器上启动一个或多个脚本解析守护进程。当 HTTP 服务器每次遇到动态程序时，可以直接交付给 FastCGI 进程来执行，然后将得到的结果返回给浏览器。这种方式可以让 HTTP 服务器专一地处理静态请求或者将动态脚本服务器的结果返回给客户端，这在很大程度上提高了整个应用系统的性能。</p>
        
          <p class="article-more-link">
            <a href="/2016/05/28/Nginx-FastCGI-运行原理/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/28/Nginx-FastCGI-运行原理/" data-id="cirbnztii003mc5pvbp872sfl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Nginx-的进程模型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/28/Nginx-的进程模型/" class="article-date">
  <time datetime="2016-05-28T07:37:57.000Z" itemprop="datePublished">2016-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Nginx/">Nginx</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/28/Nginx-的进程模型/">Nginx 的进程模型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>工作方式上，Nginx 分为单工作进程和多工作进程模式。在单工作进程模式下，除主进程外，还有一个工作进程。工作进程是单线程的；在多工作进程模式下，每个工作进程包含多个线程。Nginx 默认为单工作进程模式。</p>
<p>Nginx 启动后，洄游一个 master 进程和多个 worker 进程。</p>
        
          <p class="article-more-link">
            <a href="/2016/05/28/Nginx-的进程模型/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/28/Nginx-的进程模型/" data-id="cirbnztir003uc5pv6b33677w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Microsoft-SQL-Server-SET-NOCOUNT-ON-的含义" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/25/Microsoft-SQL-Server-SET-NOCOUNT-ON-的含义/" class="article-date">
  <time datetime="2016-05-25T03:07:56.000Z" itemprop="datePublished">2016-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Microsoft-SQL-Server/">Microsoft SQL Server</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/25/Microsoft-SQL-Server-SET-NOCOUNT-ON-的含义/">Microsoft SQL Server SET NOCOUNT ON 的含义</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>每次我们在使用查询分析器调试SQL语句的时候，通常会看到一些信息，提醒我们当前有多少个行受到了影响，这是些什么信息？在我们调用的时候这些信息有用吗？是否可以关闭呢？ </p>
<p>答案是这些信息在我们的客户端的应用程序中是没有用的，这些信息是存储过程中的每个语句的DONE_IN_PROC 信息。 </p>
<p>我们可以利用SET NOCOUNT 来控制这些信息，以达到提高程序性能的目的。</p>
        
          <p class="article-more-link">
            <a href="/2016/05/25/Microsoft-SQL-Server-SET-NOCOUNT-ON-的含义/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/25/Microsoft-SQL-Server-SET-NOCOUNT-ON-的含义/" data-id="cirbnzthr002tc5pvu8qzm0ww" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Zabbix-Template-SQL-Server" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/25/Zabbix-Template-SQL-Server/" class="article-date">
  <time datetime="2016-05-25T02:56:00.000Z" itemprop="datePublished">2016-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Zabbix/">Zabbix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/25/Zabbix-Template-SQL-Server/">Zabbix Template SQL Server</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th style="text-align:left">KEY</th>
<th style="text-align:left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">perf_counter[“\Process(sqlservr)\% Processor Time”]</td>
<td style="text-align:left">处理器时间百分比</td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Buffer Manager\Page Life Expectancy”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189628(v=sql.105).aspx" target="_blank" rel="external">页若不被引用将在缓冲池中停留的秒数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Buffer Manager\Database pages”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189628(v=sql.105).aspx" target="_blank" rel="external">缓冲池中有数据库内容的页数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:General Statistics\Processes blocked”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms190697(v=sql.105).aspx" target="_blank" rel="external">当前阻塞的进程数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:General Statistics\User Connections”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms190697(v=sql.105).aspx" target="_blank" rel="external">当前与 SQL Server 连接的用户数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Memory Manager\Total Server Memory (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms190924(v=sql.105).aspx" target="_blank" rel="external">从缓冲池提交的内存(KB),这不是 SQL Server 使用的总内存</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Transactions\Longest Transaction Running Time”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189038(v=sql.105).aspx" target="_blank" rel="external">比任何其他当前事务活动时间都长的事务启动后运行的时间长度（秒）</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Locks(_Total)\Lock Waits/sec”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms190216(v=sql.105).aspx" target="_blank" rel="external">每秒要求调用者等待的锁请求数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Locks(_Total)\Number of Deadlocks/sec”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms190216(v=sql.105).aspx" target="_blank" rel="external">每秒导致死锁的锁请求数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(_Total)\Transactions/sec”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">每秒为所有数据库启动的事务数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(model)\Transactions/sec”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">每秒为数据库启动的事务数</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(model)\Data File(s) Size (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">数据库中所有数据文件的累计大小(KB)，包括任何自动增长</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(_Total)\Data File(s) Size (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">所有数据库数据文件的累计大小(KB)，包括任何自动增长</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(model)\Log File(s) Size (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">数据库中所有事务日志文件的累计大小(KB)</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(model)\Log File(s) Used Size (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">数据库中所有日志文件的累计已用大小</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLServer:Databases(_Total)\Log File(s) Size (KB)”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms189883(v=sql.105).aspx" target="_blank" rel="external">所有数据库事务日志文件的累计大小(KB)</a></td>
</tr>
<tr>
<td style="text-align:left">perf_counter[“\SQLAgent:Jobs(_Total)\Failed jobs”]</td>
<td style="text-align:left"><a href="https://technet.microsoft.com/zh-cn/library/ms177481(v=sql.105).aspx" target="_blank" rel="external">该计数器报告失败退出的作业数</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>参考：<a href="https://technet.microsoft.com/zh-cn/library/ms191246(v=sql.105).aspx" target="_blank" rel="external">https://technet.microsoft.com/zh-cn/library/ms191246(v=sql.105).aspx</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/25/Zabbix-Template-SQL-Server/" data-id="cirbnztjz005ec5pvl15nmxqt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Zabbix-Discovery-of-file-systems" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/24/Zabbix-Discovery-of-file-systems/" class="article-date">
  <time datetime="2016-05-24T08:13:42.000Z" itemprop="datePublished">2016-05-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Zabbix/">Zabbix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/24/Zabbix-Discovery-of-file-systems/">Zabbix Discovery of file systems</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>To configure the discovery of file systems, do the follwing:</p>
<ul>
<li><p>Go to: <strong>Configuration</strong> –&gt; <strong>Templates</strong></p>
</li>
<li><p>Click on <strong>Discovery</strong> in the row of an appropriate template</p>
</li>
</ul>
        
          <p class="article-more-link">
            <a href="/2016/05/24/Zabbix-Discovery-of-file-systems/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/24/Zabbix-Discovery-of-file-systems/" data-id="cirbnztji004pc5pvx9p4eco7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Zabbix-Discovery" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/24/Zabbix-Discovery/" class="article-date">
  <time datetime="2016-05-24T03:38:52.000Z" itemprop="datePublished">2016-05-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Zabbix/">Zabbix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/24/Zabbix-Discovery/">Zabbix Discovery</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Low-level-discovery"><a href="#Low-level-discovery" class="headerlink" title="Low-level discovery"></a>Low-level discovery</h3><h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>Low-level discovery provides a way to automatically create items, triggers, and graphs for different entities on a computer. Zabbix can automatically start monitoring file systems or network interfaces on your machine, without the need to create items for each file system or network interface manually. Additionally it is possible to configure Zabbix to remove unneeded entities automatically based on actual results of periodically performed discovery.</p>
<p>In Zabbix, six types of discovery items are supported out of the box:</p>
<ul>
<li>discovery of file systems;</li>
<li>discovery of network interfaces;</li>
<li>discovery of CPUs and CPU cores;</li>
<li>discovery of SNMP OIDs;</li>
<li>discovery using ODBC SQL queries;</li>
<li>discovery of Windows services;</li>
</ul>
<p>A user can define their own types of discovery, provided they follow a particular JSON protocol.</p>
<p>The general architecture of the discovery process is as follows.</p>
<p>First, a user creates a discovery rule in “Configuration” –&gt; “Templates” –&gt; “Discovery” column. A discovery rule consists of (1) an item that discovers the necessary entities (for instance, filesystems or network interface) and (2) prototypes of items, triggers, and graphs that should be created based on the value of that item.</p>
<p>An item that discovers the necessary entities is like a regular item seen elsewhere: the server asks a Zabbix agent (or whatever the type of the item is set to) for a value of that item, the agent responds with a textual value. The difference is that the value the agent responds with should contain a list of discovered entities in a specific JSON format. While the details of this format are only important for implementers of custom discovery checks, it is necessary to know that the returned value contains a list of macro → value pairs. For instance, item “net.if.discovery” might return two pairs: “#IFNAME” → “lo” and “#IFNAME” → “eth0”.</p>
<p>When the server receives a value for a discovery item, it looks at the macro → value pairs and <strong>for each</strong> pair generates real items, triggers, and graphs, based on their prototypes. In the example with “net.if.discovery” above, the server would generate one set of items, triggers, and graphs for the loopback interface “lo”, and another set for interface “eth0”. </p>
        
          <p class="article-more-link">
            <a href="/2016/05/24/Zabbix-Discovery/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/24/Zabbix-Discovery/" data-id="cirbnztjp004zc5pvv3qx0mwe" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Zabbix-Server-Installing-And-Configuration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/24/Zabbix-Server-Installing-And-Configuration/" class="article-date">
  <time datetime="2016-05-24T02:35:04.000Z" itemprop="datePublished">2016-05-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Zabbix/">Zabbix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/24/Zabbix-Server-Installing-And-Configuration/">Zabbix Server Installing And Configuration</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Installing-repository-configuration-package"><a href="#Installing-repository-configuration-package" class="headerlink" title="Installing repository configuration package"></a>Installing repository configuration package</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://repo.zabbix.com/zabbix/3.0/rhel/7/x86_64/zabbix-release-3.0-1.el7.noarch.rpm</span><br></pre></td></tr></table></figure>
<h3 id="Installing-Zabbix-packages"><a href="#Installing-Zabbix-packages" class="headerlink" title="Installing Zabbix packages"></a>Installing Zabbix packages</h3><p>通过zabbix提供的下载源，下载并安装zabbix-server-mysql和zabbix-web-mysql，这两个mysql数据库是用来存放采集到的数据，Zabbix的web端会通过这些数据，来展示绘图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install zabbix-server-mysql zabbix-web-mysql</span><br></pre></td></tr></table></figure>
<h3 id="Installing-And-Configuration-Database"><a href="#Installing-And-Configuration-Database" class="headerlink" title="Installing And Configuration Database"></a>Installing And Configuration Database</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## Install</span><br><span class="line">[root@localhost ~]# yum install mariadb-server mariadb</span><br><span class="line"></span><br><span class="line">## Start</span><br><span class="line">[root@localhost ~]# systemctl enable mariadb</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/mariadb.service to /usr/lib/systemd/system/mariadb.service.</span><br><span class="line">[root@localhost ~]# systemctl start mariadb</span><br><span class="line"></span><br><span class="line">## Privilege</span><br><span class="line">CREATE DATABASE zabbix character set utf8 collate utf8_bin;</span><br><span class="line">GRANT ALL PRIVILEGES ON on zabbix.* to zabbix@localhost IDENTIFIED BY &apos;zabbix&apos;;</span><br></pre></td></tr></table></figure>
<h3 id="Create-initial-database"><a href="#Create-initial-database" class="headerlink" title="Create initial database"></a>Create initial database</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/doc/zabbix-server-mysql-3.0.2/</span><br><span class="line">zabbix-server-mysql-3.0.2]# zcat create.sql.gz | mysql -u root -p zabbix</span><br></pre></td></tr></table></figure>
<h3 id="Starting-Zabbix-server-process"><a href="#Starting-Zabbix-server-process" class="headerlink" title="Starting Zabbix server process"></a>Starting Zabbix server process</h3><p>Edit database configuration in <strong>zabbix_server.conf</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/zabbix/zabbix_server.conf</span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=zabbix</span><br></pre></td></tr></table></figure>
<p>Start Zabbix server process</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start zabbix-server</span><br><span class="line">systemctl enable zabbix-server</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/zabbix-server.service to /usr/lib/systemd/system/zabbix-server.service.</span><br></pre></td></tr></table></figure>
<h3 id="Editing-PHP-configuration-for-Zabbix-frontend"><a href="#Editing-PHP-configuration-for-Zabbix-frontend" class="headerlink" title="Editing PHP configuration for Zabbix frontend"></a>Editing PHP configuration for Zabbix frontend</h3><p>Apache configuration file for Zabbix frontend is located in <strong>/etc/httpd/conf.d/zabbix.conf</strong>. Some PHP settings are alread configured.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">php_value max_execution_time 300</span><br><span class="line">php_value memory_limit 128M</span><br><span class="line">php_value post_max_size 16M</span><br><span class="line">php_value upload_max_filesize 2M</span><br><span class="line">php_value max_input_time 300</span><br><span class="line">php_value always_populate_raw_post_data -1</span><br><span class="line"># php_value date.timezone Europe/Riga</span><br><span class="line">php_value date.timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>
<h3 id="Start-Http-server-process"><a href="#Start-Http-server-process" class="headerlink" title="Start Http server process"></a>Start Http server process</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start httpd</span><br><span class="line">systemctl enable httpd</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/httpd.service to /usr/lib/systemd/system/httpd.service.</span><br></pre></td></tr></table></figure>
<p>Zabbix frontend is available at <strong><a href="http://zabbix-frontend-hostname/zabbix" target="_blank" rel="external">http://zabbix-frontend-hostname/zabbix</a></strong> in the browser. Default username/password is Admin/zabbix.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ttlop.com/2016/05/24/Zabbix-Server-Installing-And-Configuration/" data-id="cirbnztjs0054c5pv124pi5lp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/6/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/8/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Apache/">Apache</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Centos-7/">Centos 7</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Iptables/">Iptables</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Microsoft-SQL-Server/">Microsoft SQL Server</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MikroTik/">MikroTik</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nagios/">Nagios</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Postfix/">Postfix</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/30/TCP-连接的状态/">TCP 连接的状态</a>
          </li>
        
          <li>
            <a href="/2016/07/30/Linux-apache-access-log-Analy/">Linux apache access_log Analy</a>
          </li>
        
          <li>
            <a href="/2016/07/29/Centos-7-安装-memcache-及-安装-php-扩展/">Centos 7 安装 memcache 及 安装 php 扩展</a>
          </li>
        
          <li>
            <a href="/2016/07/29/使用-Apachetop-实时监测-web-服务器运行状态/">使用 Apachetop 实时监测 web 服务器运行状态</a>
          </li>
        
          <li>
            <a href="/2016/07/28/Zabbix-TCP-连接数监控/">Zabbix TCP 连接数监控</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 XiaoYong Hu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/About" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>